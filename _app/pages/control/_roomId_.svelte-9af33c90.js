import{S as R,i as C,s as F,e as y,k as J,t as K,c as S,a as P,d as b,m as O,h as Q,b as k,P as V,g as W,J as v,N as $,o as A,p as G,q as N,j as H,O as L,Q as X,v as Y,n as Z,R as x,T as ee,w as D,x as E,y as T,K as U,B as q,U as te}from"../../chunks/vendor-c00b176d.js";import{p as se}from"../../chunks/stores-bb3352fd.js";import{b as z}from"../../chunks/paths-4b3c6e7e.js";import{g as ae}from"../../chunks/navigation-bd39ff07.js";import"../../chunks/singletons-a6a7384f.js";function oe(r){let t,s;return t=new x({props:{icon:ee,size:"2x"}}),{c(){D(t.$$.fragment)},l(e){E(t.$$.fragment,e)},m(e,a){T(t,e,a),s=!0},p:U,i(e){s||(N(t.$$.fragment,e),s=!0)},o(e){A(t.$$.fragment,e),s=!1},d(e){q(t,e)}}}function ne(r){let t,s;return t=new x({props:{icon:te,size:"2x"}}),{c(){D(t.$$.fragment)},l(e){E(t.$$.fragment,e)},m(e,a){T(t,e,a),s=!0},p:U,i(e){s||(N(t.$$.fragment,e),s=!0)},o(e){A(t.$$.fragment,e),s=!1},d(e){q(t,e)}}}function re(r){let t,s,e,a,c,u,l,h,i,d,m;const f=[ne,oe],p=[];function I(o,n){return o[2]?0:1}return e=I(r),a=p[e]=f[e](r),{c(){t=y("div"),s=y("div"),a.c(),c=J(),u=y("div"),l=y("span"),h=K(r[0]),this.h()},l(o){t=S(o,"DIV",{id:!0,class:!0});var n=P(t);s=S(n,"DIV",{class:!0});var _=P(s);a.l(_),_.forEach(b),c=O(n),u=S(n,"DIV",{class:!0});var j=P(u);l=S(j,"SPAN",{class:!0});var w=P(l);h=Q(w,r[0]),w.forEach(b),j.forEach(b),n.forEach(b),this.h()},h(){k(s,"class","absolute top-3 left-3"),k(l,"class","clock svelte-jj001p"),V(l,"text-red-600",r[1]),k(u,"class","h-full w-full flex flex-col justify-center items-center"),k(t,"id","main"),k(t,"class","w-screen h-screen overflow-hidden svelte-jj001p")},m(o,n){W(o,t,n),v(t,s),p[e].m(s,null),v(t,c),v(t,u),v(u,l),v(l,h),i=!0,d||(m=[$(s,"click",r[5]),$(t,"click",r[3],{once:!0})],d=!0)},p(o,[n]){let _=e;e=I(o),e===_?p[e].p(o,n):(Z(),A(p[_],1,1,()=>{p[_]=null}),G(),a=p[e],a?a.p(o,n):(a=p[e]=f[e](o),a.c()),N(a,1),a.m(s,null)),(!i||n&1)&&H(h,o[0]),n&2&&V(l,"text-red-600",o[1])},i(o){i||(N(a),i=!0)},o(o){A(a),i=!1},d(o){o&&b(t),p[e].d(),d=!1,L(m)}}}function le(r,t,s){let e;X(r,se,n=>s(10,e=n));let a=e.params.roomId,c,u,l,h="",i=!1,d,m=!1,f;Y(()=>{e.url.searchParams.has("pin")?c=e.url.searchParams.get("pin"):(c=sessionStorage.getItem("PIN-"+a),c||(c=prompt("Please enter the control PIN for room "+a))),c?(sessionStorage.setItem("PIN-"+a,c),I(),f=new Audio(z+"/audio/beep.mp3")):ae(z+"/")});function p(){s(2,m=!0),f.play(),f.pause(),f.load()}function I(n){u=new WebSocket("wss://tobias-reinke.de/shotclock/"+a),u.onerror=function(g){console.log(g)},u.onmessage=function(g){let B=g.data.substring(0,1),M=g.data.substring(2).includes(";")?g.data.substring(2).split(";"):[g.data.substring(2)];switch(B){case"t":s(4,l=parseInt(M[1])),l==0?_():j();break}};function _(){d===void 0&&(s(1,i=!0),w(),d=setInterval(function(){s(1,i=!i)},500))}function j(){d&&(clearInterval(d),d=void 0,s(1,i=!1))}function w(){m&&(f.play(),setTimeout(function(){f.pause(),f.load()},2e3))}}const o=()=>s(2,m=!m);return r.$$.update=()=>{r.$$.dirty&16&&l!==void 0&&s(0,h=l.toString().padStart(2,"0"))},[h,i,m,p,l,o]}class de extends R{constructor(t){super();C(this,t,le,re,F,{})}}export{de as default};
