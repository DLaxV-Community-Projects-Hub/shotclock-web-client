import{S as Ot,i as qt,s as Rt,e as n,c,a as i,d as a,b as f,g as ve,X as se,o as M,p as $t,q as W,Y as jt,F as Ut,v as Lt,a1 as Ft,n as zt,_ as Mt,w as Pe,x as Ae,y as Ve,L as ft,B as Be,P as Ge,a2 as Ct,k as N,t as h,m as S,h as g,a3 as J,R as l,j as B,a4 as Wt,a5 as Ht}from"../../chunks/vendor-6d995ebd.js";import{p as Xt,w as Gt,s as Kt}from"../../chunks/config-49fddc90.js";import{b as y}from"../../chunks/paths-b0acc198.js";import{L as Yt}from"../../chunks/LoadingInfo-636a75e3.js";import{g as ut}from"../../chunks/navigation-ecedacd4.js";const{window:Jt}=Ft;function Qt(o){let s,t;return s=new Yt({}),{c(){Pe(s.$$.fragment)},l(e){Ae(s.$$.fragment,e)},m(e,_){Ve(s,e,_),t=!0},p:ft,i(e){t||(W(s.$$.fragment,e),t=!0)},o(e){M(s.$$.fragment,e),t=!1},d(e){Be(s,e)}}}function Zt(o){let s,t,e,_,d,b,D,k,P,u,m,w,Q,A,$=o[7]("control.reset")+"",T,he,z,V,j,H,Z=o[7]("control.room")+"",oe,ge,X,be,ke,v,I,x=o[7]("control.room_url")+"",ee,Ke,q,Te,Ye,Je,Qe,Ze,re,ae,R,ne,we=o[7]("control.share_room_url")+"",ye,xe,te,et,C,G,ce,Ie=o[7]("control.pin")+"",$e,tt,ie,je,lt,K,fe,Ee=o[7]("control.controller_url")+"",Ue,st,L,ze,ot,rt,at,nt,ue,de,F,_e,Ne=o[7]("control.share_controller_url")+"",Ce,ct,le,E,it,dt;const _t=[el,xt],Y=[];function pt(r,p){return r[6]?0:1}t=pt(o),e=Y[t]=_t[t](o);function mt(r,p){return r[5]?ll:tl}let Oe=mt(o),U=Oe(o);return te=new Ge({props:{icon:Ct,size:"lg"}}),le=new Ge({props:{icon:Ct,size:"lg"}}),{c(){s=n("div"),e.c(),_=N(),d=n("div"),b=n("div"),D=n("span"),k=h(o[3]),P=N(),u=n("div"),m=n("button"),w=n("span"),U.c(),Q=N(),A=n("button"),T=h($),he=N(),z=n("div"),V=n("div"),j=n("div"),H=n("span"),oe=h(Z),ge=N(),X=n("span"),be=h(o[8]),ke=N(),v=n("div"),I=n("span"),ee=h(x),Ke=N(),q=n("a"),Te=h(o[1]),Ye=h(y),Je=h("/room/"),Qe=h(o[8]),Ze=N(),re=n("div"),ae=n("button"),R=n("div"),ne=n("span"),ye=h(we),xe=N(),Pe(te.$$.fragment),et=N(),C=n("div"),G=n("div"),ce=n("span"),$e=h(Ie),tt=N(),ie=n("span"),je=h(o[0]),lt=N(),K=n("div"),fe=n("span"),Ue=h(Ee),st=N(),L=n("a"),ze=h(o[1]),ot=h(y),rt=h("/control/"),at=h(o[8]),nt=N(),ue=n("div"),de=n("button"),F=n("div"),_e=n("span"),Ce=h(Ne),ct=N(),Pe(le.$$.fragment),this.h()},l(r){s=c(r,"DIV",{class:!0});var p=i(s);e.l(p),p.forEach(a),_=S(r),d=c(r,"DIV",{class:!0});var O=i(d);b=c(O,"DIV",{class:!0});var vt=i(b);D=c(vt,"SPAN",{class:!0});var ht=i(D);k=g(ht,o[3]),ht.forEach(a),vt.forEach(a),P=S(O),u=c(O,"DIV",{class:!0});var qe=i(u);m=c(qe,"BUTTON",{class:!0});var gt=i(m);w=c(gt,"SPAN",{});var bt=i(w);U.l(bt),bt.forEach(a),gt.forEach(a),Q=S(qe),A=c(qe,"BUTTON",{class:!0});var kt=i(A);T=g(kt,$),kt.forEach(a),qe.forEach(a),he=S(O),z=c(O,"DIV",{class:!0});var Re=i(z);V=c(Re,"DIV",{class:!0});var pe=i(V);j=c(pe,"DIV",{class:!0});var Le=i(j);H=c(Le,"SPAN",{class:!0});var wt=i(H);oe=g(wt,Z),wt.forEach(a),ge=S(Le),X=c(Le,"SPAN",{class:!0});var It=i(X);be=g(It,o[8]),It.forEach(a),Le.forEach(a),ke=S(pe),v=c(pe,"DIV",{class:!0});var Fe=i(v);I=c(Fe,"SPAN",{class:!0});var Et=i(I);ee=g(Et,x),Et.forEach(a),Ke=S(Fe),q=c(Fe,"A",{href:!0});var Se=i(q);Te=g(Se,o[1]),Ye=g(Se,y),Je=g(Se,"/room/"),Qe=g(Se,o[8]),Se.forEach(a),Fe.forEach(a),Ze=S(pe),re=c(pe,"DIV",{});var Nt=i(re);ae=c(Nt,"BUTTON",{class:!0});var St=i(ae);R=c(St,"DIV",{class:!0});var Me=i(R);ne=c(Me,"SPAN",{class:!0});var Dt=i(ne);ye=g(Dt,we),Dt.forEach(a),xe=S(Me),Ae(te.$$.fragment,Me),Me.forEach(a),St.forEach(a),Nt.forEach(a),pe.forEach(a),et=S(Re),C=c(Re,"DIV",{class:!0});var me=i(C);G=c(me,"DIV",{class:!0});var We=i(G);ce=c(We,"SPAN",{class:!0});var Pt=i(ce);$e=g(Pt,Ie),Pt.forEach(a),tt=S(We),ie=c(We,"SPAN",{class:!0});var At=i(ie);je=g(At,o[0]),At.forEach(a),We.forEach(a),lt=S(me),K=c(me,"DIV",{class:!0});var He=i(K);fe=c(He,"SPAN",{class:!0});var Vt=i(fe);Ue=g(Vt,Ee),Vt.forEach(a),st=S(He),L=c(He,"A",{href:!0});var De=i(L);ze=g(De,o[1]),ot=g(De,y),rt=g(De,"/control/"),at=g(De,o[8]),De.forEach(a),He.forEach(a),nt=S(me),ue=c(me,"DIV",{});var Bt=i(ue);de=c(Bt,"BUTTON",{class:!0});var Tt=i(de);F=c(Tt,"DIV",{class:!0});var Xe=i(F);_e=c(Xe,"SPAN",{class:!0});var yt=i(_e);Ce=g(yt,Ne),yt.forEach(a),ct=S(Xe),Ae(le.$$.fragment,Xe),Xe.forEach(a),Tt.forEach(a),Bt.forEach(a),me.forEach(a),Re.forEach(a),O.forEach(a),this.h()},h(){f(s,"class","absolute top-3 left-3"),f(D,"class","clock svelte-qg5rdz"),J(D,"text-red-600",o[4]),f(b,"class","flex flex-col justify-center items-center"),f(m,"class","controlButton svelte-qg5rdz"),J(m,"startButton",!o[5]),J(m,"stopButton",o[5]),f(A,"class","controlButton shadow-reset text-white bg-button-bg-reset svelte-qg5rdz"),f(u,"class","flex flex-row lg:flex-col justify-evenly"),f(H,"class","text-xs"),f(X,"class","text-xl"),f(j,"class","flex flex-col mb-3 mr-5 lg:mr-0"),f(I,"class","text-xs"),f(q,"href",""+(y+"/room/"+o[8])),f(v,"class","hidden lg:flex flex-col mb-3"),f(ne,"class","mr-2"),f(R,"class","flex flex-row items-center"),f(ae,"class","shareButton lg:text-lg svelte-qg5rdz"),J(re,"hidden",!navigator.share),f(V,"class","lg:mb-10 w-1/2 lg:w-full"),f(ce,"class","text-xs"),f(ie,"class","text-xl"),f(G,"class","flex flex-col mb-3"),f(fe,"class","text-xs"),f(L,"href",""+(y+"/control/"+o[8])),f(K,"class","hidden lg:flex flex-col mb-3"),f(_e,"class","mr-2"),f(F,"class","flex flex-row items-center"),f(de,"class","shareButton lg:text-lg svelte-qg5rdz"),J(ue,"hidden",!navigator.share),f(C,"class","w-1/2 lg:w-full"),f(z,"class","lg:text-right flex flex-row lg:flex-col justify-between lg:justify-start m-3"),f(d,"class","h-full w-full flex flex-col lg:flex-row justify-between")},m(r,p){ve(r,s,p),Y[t].m(s,null),ve(r,_,p),ve(r,d,p),l(d,b),l(b,D),l(D,k),l(d,P),l(d,u),l(u,m),l(m,w),U.m(w,null),l(u,Q),l(u,A),l(A,T),l(d,he),l(d,z),l(z,V),l(V,j),l(j,H),l(H,oe),l(j,ge),l(j,X),l(X,be),l(V,ke),l(V,v),l(v,I),l(I,ee),l(v,Ke),l(v,q),l(q,Te),l(q,Ye),l(q,Je),l(q,Qe),l(V,Ze),l(V,re),l(re,ae),l(ae,R),l(R,ne),l(ne,ye),l(R,xe),Ve(te,R,null),l(z,et),l(z,C),l(C,G),l(G,ce),l(ce,$e),l(G,tt),l(G,ie),l(ie,je),l(C,lt),l(C,K),l(K,fe),l(fe,Ue),l(K,st),l(K,L),l(L,ze),l(L,ot),l(L,rt),l(L,at),l(C,nt),l(C,ue),l(ue,de),l(de,F),l(F,_e),l(_e,Ce),l(F,ct),Ve(le,F,null),E=!0,it||(dt=[se(s,"click",o[16]),se(m,"click",o[10]),se(A,"click",o[11]),se(R,"click",o[12]),se(F,"click",o[13])],it=!0)},p(r,p){let O=t;t=pt(r),t===O?Y[t].p(r,p):(zt(),M(Y[O],1,1,()=>{Y[O]=null}),$t(),e=Y[t],e?e.p(r,p):(e=Y[t]=_t[t](r),e.c()),W(e,1),e.m(s,null)),(!E||p&8)&&B(k,r[3]),p&16&&J(D,"text-red-600",r[4]),Oe===(Oe=mt(r))&&U?U.p(r,p):(U.d(1),U=Oe(r),U&&(U.c(),U.m(w,null))),p&32&&J(m,"startButton",!r[5]),p&32&&J(m,"stopButton",r[5]),(!E||p&128)&&$!==($=r[7]("control.reset")+"")&&B(T,$),(!E||p&128)&&Z!==(Z=r[7]("control.room")+"")&&B(oe,Z),(!E||p&128)&&x!==(x=r[7]("control.room_url")+"")&&B(ee,x),(!E||p&2)&&B(Te,r[1]),(!E||p&128)&&we!==(we=r[7]("control.share_room_url")+"")&&B(ye,we),(!E||p&128)&&Ie!==(Ie=r[7]("control.pin")+"")&&B($e,Ie),(!E||p&1)&&B(je,r[0]),(!E||p&128)&&Ee!==(Ee=r[7]("control.controller_url")+"")&&B(Ue,Ee),(!E||p&2)&&B(ze,r[1]),(!E||p&128)&&Ne!==(Ne=r[7]("control.share_controller_url")+"")&&B(Ce,Ne)},i(r){E||(W(e),W(te.$$.fragment,r),W(le.$$.fragment,r),E=!0)},o(r){M(e),M(te.$$.fragment,r),M(le.$$.fragment,r),E=!1},d(r){r&&a(s),Y[t].d(),r&&a(_),r&&a(d),U.d(),Be(te),Be(le),it=!1,jt(dt)}}}function xt(o){let s,t;return s=new Ge({props:{icon:Wt,size:"2x"}}),{c(){Pe(s.$$.fragment)},l(e){Ae(s.$$.fragment,e)},m(e,_){Ve(s,e,_),t=!0},p:ft,i(e){t||(W(s.$$.fragment,e),t=!0)},o(e){M(s.$$.fragment,e),t=!1},d(e){Be(s,e)}}}function el(o){let s,t;return s=new Ge({props:{icon:Ht,size:"2x"}}),{c(){Pe(s.$$.fragment)},l(e){Ae(s.$$.fragment,e)},m(e,_){Ve(s,e,_),t=!0},p:ft,i(e){t||(W(s.$$.fragment,e),t=!0)},o(e){M(s.$$.fragment,e),t=!1},d(e){Be(s,e)}}}function tl(o){let s=o[7]("control.start")+"",t;return{c(){t=h(s)},l(e){t=g(e,s)},m(e,_){ve(e,t,_)},p(e,_){_&128&&s!==(s=e[7]("control.start")+"")&&B(t,s)},d(e){e&&a(t)}}}function ll(o){let s=o[7]("control.stop")+"",t;return{c(){t=h(s)},l(e){t=g(e,s)},m(e,_){ve(e,t,_)},p(e,_){_&128&&s!==(s=e[7]("control.stop")+"")&&B(t,s)},d(e){e&&a(t)}}}function sl(o){let s,t,e,_,d,b;const D=[Zt,Qt],k=[];function P(u,m){return u[2]?0:1}return t=P(o),e=k[t]=D[t](o),{c(){s=n("div"),e.c(),this.h()},l(u){s=c(u,"DIV",{id:!0,class:!0});var m=i(s);e.l(m),m.forEach(a),this.h()},h(){f(s,"id","main"),f(s,"class","w-full h-full overflow-hidden svelte-qg5rdz")},m(u,m){ve(u,s,m),k[t].m(s,null),_=!0,d||(b=[se(Jt,"keydown",o[14]),se(s,"click",o[9],{once:!0})],d=!0)},p(u,[m]){let w=t;t=P(u),t===w?k[t].p(u,m):(zt(),M(k[w],1,1,()=>{k[w]=null}),$t(),e=k[t],e?e.p(u,m):(e=k[t]=D[t](u),e.c()),W(e,1),e.m(s,null))},i(u){_||(W(e),_=!0)},o(u){M(e),_=!1},d(u){u&&a(s),k[t].d(),d=!1,jt(b)}}}function ol(o,s,t){let e,_;Ut(o,Xt,v=>t(20,e=v)),Ut(o,Mt,v=>t(7,_=v));let d=e.params.roomId,b,D,k=!1,P,u,m="",w=!1,Q,A,$=!1,T;Lt(()=>{t(1,D=window.location.host),e.url.searchParams.has("pin")?t(0,b=e.url.searchParams.get("pin")):(t(0,b=sessionStorage.getItem("PIN-"+d)),b||t(0,b=prompt("Please enter the control PIN for room "+d))),b?(sessionStorage.setItem("PIN-"+d,b),z(b),T=new Audio(y+"/audio/beep.mp3")):ut(y+"/")});function he(){t(6,$=!0),T.play(),T.pause(),T.load()}function z(v){P=new WebSocket(Gt+"://"+Kt+"/"+d+"?pin="+v),P.onerror=function(I){console.log(I)},P.onmessage=function(I){if(I.data==="ROOM_NOT_FOUND")alert("The room "+d+" does not exist"),ut(y+"/");else if(I.data==="WRONG_PIN")alert("Wrong PIN"),sessionStorage.removeItem("PIN-"+d),ut(y+"/");else if(I.data==="AUTHENTICATED")t(2,k=!0);else{let x=I.data.substring(0,1),ee=I.data.substring(2).includes(";")?I.data.substring(2).split(";"):[I.data.substring(2)];switch(x){case"t":t(15,u=parseInt(ee[1])),u==0?H():Z();break;case"r":t(5,Q=ee[0]==="1");break}}}}function V(){Q?P.send("pause"):P.send("start")}function j(){P.send("reset")}function H(){A===void 0&&(t(4,w=!0),oe(),A=setInterval(function(){t(4,w=!w)},500))}function Z(){A&&(clearInterval(A),A=void 0,t(4,w=!1))}function oe(){$&&(T.play(),setTimeout(function(){T.pause(),T.load()},2e3))}function ge(){navigator.share&&navigator.share({title:"Shot Clock room "+d,url:y+"/room/"+d})}function X(){navigator.share&&navigator.share({title:"Shot Clock controller "+d,url:y+"/control/"+d})}function be(v){v.keyCode===32||v.keyCode===13?(V(),v.preventDefault()):(v.keyCode===67||v.keyCode===77||v.keyCode==8)&&(j(),v.preventDefault())}const ke=()=>t(6,$=!$);return o.$$.update=()=>{o.$$.dirty&32768&&u!==void 0&&t(3,m=u.toString().padStart(2,"0"))},[b,D,k,m,w,Q,$,_,d,he,V,j,ge,X,be,u,ke]}class fl extends Ot{constructor(s){super();qt(this,s,ol,sl,Rt,{})}}export{fl as default};
