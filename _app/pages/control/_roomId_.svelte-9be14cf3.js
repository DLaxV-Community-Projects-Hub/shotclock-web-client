import{S as Ot,i as qt,s as Ct,e as n,c,a as i,d as a,b as u,g as ge,X as se,o as X,p as Ut,q as K,Y as $t,F as ft,v as Rt,a1 as Ft,n as zt,G as Mt,_ as Wt,w as Ae,x as Ve,y as Be,L as ut,B as Te,P as Ke,a2 as Lt,k as N,t as g,m as S,h as b,a3 as x,R as l,j as P,a4 as Gt,a5 as Ht}from"../../chunks/vendor-6d995ebd.js";import{p as Xt,w as Kt,s as Yt}from"../../chunks/config-49fddc90.js";import{b as V}from"../../chunks/paths-b0acc198.js";import{L as Jt}from"../../chunks/LoadingInfo-636a75e3.js";import{g as dt}from"../../chunks/navigation-ecedacd4.js";const{window:Qt}=Ft;function Zt(o){let s,t;return s=new Jt({}),{c(){Ae(s.$$.fragment)},l(e){Ve(s.$$.fragment,e)},m(e,d){Be(s,e,d),t=!0},p:ut,i(e){t||(K(s.$$.fragment,e),t=!0)},o(e){X(s.$$.fragment,e),t=!1},d(e){Te(s,e)}}}function xt(o){let s,t,e,d,k,v,h,w,C,f,_,D,R,B,T=o[8]("control.reset")+"",$,y,z,A,j,F,ee=o[8]("control.room")+"",oe,be,Y,ke,we,L,m,E=o[8]("control.room_url")+"",re,ae,M,ye,Ye,Je,Qe,Ze,ne,ce,W,ie,Ee=o[8]("control.share_room_url")+"",je,xe,te,et,O,J,fe,Ie=o[8]("control.pin")+"",Ue,tt,ue,$e,lt,Q,de,Ne=o[8]("control.controller_url")+"",ze,st,G,Le,ot,rt,at,nt,_e,pe,H,me,Se=o[8]("control.share_controller_url")+"",Oe,ct,le,I,it,_t;const pt=[tl,el],Z=[];function mt(r,p){return r[6]?0:1}t=mt(o),e=Z[t]=pt[t](o);function vt(r,p){return r[5]?sl:ll}let qe=vt(o),U=qe(o);return te=new Ke({props:{icon:Lt,size:"lg"}}),le=new Ke({props:{icon:Lt,size:"lg"}}),{c(){s=n("div"),e.c(),d=N(),k=n("div"),v=n("div"),h=n("span"),w=g(o[3]),C=N(),f=n("div"),_=n("button"),D=n("span"),U.c(),R=N(),B=n("button"),$=g(T),y=N(),z=n("div"),A=n("div"),j=n("div"),F=n("span"),oe=g(ee),be=N(),Y=n("span"),ke=g(o[9]),we=N(),L=n("div"),m=n("span"),re=g(E),ae=N(),M=n("a"),ye=g(o[1]),Ye=g(V),Je=g("/room/"),Qe=g(o[9]),Ze=N(),ne=n("div"),ce=n("button"),W=n("div"),ie=n("span"),je=g(Ee),xe=N(),Ae(te.$$.fragment),et=N(),O=n("div"),J=n("div"),fe=n("span"),Ue=g(Ie),tt=N(),ue=n("span"),$e=g(o[0]),lt=N(),Q=n("div"),de=n("span"),ze=g(Ne),st=N(),G=n("a"),Le=g(o[1]),ot=g(V),rt=g("/control/"),at=g(o[9]),nt=N(),_e=n("div"),pe=n("button"),H=n("div"),me=n("span"),Oe=g(Se),ct=N(),Ae(le.$$.fragment),this.h()},l(r){s=c(r,"DIV",{class:!0});var p=i(s);e.l(p),p.forEach(a),d=S(r),k=c(r,"DIV",{class:!0});var q=i(k);v=c(q,"DIV",{class:!0});var ht=i(v);h=c(ht,"SPAN",{class:!0});var gt=i(h);w=b(gt,o[3]),gt.forEach(a),ht.forEach(a),C=S(q),f=c(q,"DIV",{class:!0});var Ce=i(f);_=c(Ce,"BUTTON",{class:!0});var bt=i(_);D=c(bt,"SPAN",{});var kt=i(D);U.l(kt),kt.forEach(a),bt.forEach(a),R=S(Ce),B=c(Ce,"BUTTON",{class:!0});var wt=i(B);$=b(wt,T),wt.forEach(a),Ce.forEach(a),y=S(q),z=c(q,"DIV",{class:!0});var Re=i(z);A=c(Re,"DIV",{class:!0});var ve=i(A);j=c(ve,"DIV",{class:!0});var Fe=i(j);F=c(Fe,"SPAN",{class:!0});var Et=i(F);oe=b(Et,ee),Et.forEach(a),be=S(Fe),Y=c(Fe,"SPAN",{class:!0});var It=i(Y);ke=b(It,o[9]),It.forEach(a),Fe.forEach(a),we=S(ve),L=c(ve,"DIV",{class:!0});var Me=i(L);m=c(Me,"SPAN",{class:!0});var Nt=i(m);re=b(Nt,E),Nt.forEach(a),ae=S(Me),M=c(Me,"A",{href:!0});var De=i(M);ye=b(De,o[1]),Ye=b(De,V),Je=b(De,"/room/"),Qe=b(De,o[9]),De.forEach(a),Me.forEach(a),Ze=S(ve),ne=c(ve,"DIV",{});var St=i(ne);ce=c(St,"BUTTON",{class:!0});var Dt=i(ce);W=c(Dt,"DIV",{class:!0});var We=i(W);ie=c(We,"SPAN",{class:!0});var Pt=i(ie);je=b(Pt,Ee),Pt.forEach(a),xe=S(We),Ve(te.$$.fragment,We),We.forEach(a),Dt.forEach(a),St.forEach(a),ve.forEach(a),et=S(Re),O=c(Re,"DIV",{class:!0});var he=i(O);J=c(he,"DIV",{class:!0});var Ge=i(J);fe=c(Ge,"SPAN",{class:!0});var At=i(fe);Ue=b(At,Ie),At.forEach(a),tt=S(Ge),ue=c(Ge,"SPAN",{class:!0});var Vt=i(ue);$e=b(Vt,o[0]),Vt.forEach(a),Ge.forEach(a),lt=S(he),Q=c(he,"DIV",{class:!0});var He=i(Q);de=c(He,"SPAN",{class:!0});var Bt=i(de);ze=b(Bt,Ne),Bt.forEach(a),st=S(He),G=c(He,"A",{href:!0});var Pe=i(G);Le=b(Pe,o[1]),ot=b(Pe,V),rt=b(Pe,"/control/"),at=b(Pe,o[9]),Pe.forEach(a),He.forEach(a),nt=S(he),_e=c(he,"DIV",{});var Tt=i(_e);pe=c(Tt,"BUTTON",{class:!0});var yt=i(pe);H=c(yt,"DIV",{class:!0});var Xe=i(H);me=c(Xe,"SPAN",{class:!0});var jt=i(me);Oe=b(jt,Se),jt.forEach(a),ct=S(Xe),Ve(le.$$.fragment,Xe),Xe.forEach(a),yt.forEach(a),Tt.forEach(a),he.forEach(a),Re.forEach(a),q.forEach(a),this.h()},h(){u(s,"class","absolute top-3 left-3"),u(h,"class","clock svelte-qg5rdz"),x(h,"text-red-600",o[4]),u(v,"class","flex flex-col justify-center items-center"),u(_,"class","controlButton svelte-qg5rdz"),x(_,"startButton",!o[5]),x(_,"stopButton",o[5]),u(B,"class","controlButton shadow-reset text-white bg-button-bg-reset svelte-qg5rdz"),u(f,"class","flex flex-row lg:flex-col justify-evenly"),u(F,"class","text-xs"),u(Y,"class","text-xl"),u(j,"class","flex flex-col mb-3 mr-5 lg:mr-0"),u(m,"class","text-xs"),u(M,"href",""+(V+"/room/"+o[9])),u(L,"class","hidden lg:flex flex-col mb-3"),u(ie,"class","mr-2"),u(W,"class","flex flex-row items-center"),u(ce,"class","shareButton lg:text-lg svelte-qg5rdz"),x(ne,"hidden",!navigator.share),u(A,"class","lg:mb-10 w-1/2 lg:w-full"),u(fe,"class","text-xs"),u(ue,"class","text-xl"),u(J,"class","flex flex-col mb-3"),u(de,"class","text-xs"),u(G,"href",""+(V+"/control/"+o[9])),u(Q,"class","hidden lg:flex flex-col mb-3"),u(me,"class","mr-2"),u(H,"class","flex flex-row items-center"),u(pe,"class","shareButton lg:text-lg svelte-qg5rdz"),x(_e,"hidden",!navigator.share),u(O,"class","w-1/2 lg:w-full"),u(z,"class","lg:text-right flex flex-row lg:flex-col justify-between lg:justify-start m-3"),u(k,"class","h-full w-full flex flex-col lg:flex-row justify-between")},m(r,p){ge(r,s,p),Z[t].m(s,null),ge(r,d,p),ge(r,k,p),l(k,v),l(v,h),l(h,w),l(k,C),l(k,f),l(f,_),l(_,D),U.m(D,null),l(f,R),l(f,B),l(B,$),l(k,y),l(k,z),l(z,A),l(A,j),l(j,F),l(F,oe),l(j,be),l(j,Y),l(Y,ke),l(A,we),l(A,L),l(L,m),l(m,re),l(L,ae),l(L,M),l(M,ye),l(M,Ye),l(M,Je),l(M,Qe),l(A,Ze),l(A,ne),l(ne,ce),l(ce,W),l(W,ie),l(ie,je),l(W,xe),Be(te,W,null),l(z,et),l(z,O),l(O,J),l(J,fe),l(fe,Ue),l(J,tt),l(J,ue),l(ue,$e),l(O,lt),l(O,Q),l(Q,de),l(de,ze),l(Q,st),l(Q,G),l(G,Le),l(G,ot),l(G,rt),l(G,at),l(O,nt),l(O,_e),l(_e,pe),l(pe,H),l(H,me),l(me,Oe),l(H,ct),Be(le,H,null),I=!0,it||(_t=[se(s,"click",o[17]),se(_,"click",o[11]),se(B,"click",o[12]),se(W,"click",o[13]),se(H,"click",o[14])],it=!0)},p(r,p){let q=t;t=mt(r),t===q?Z[t].p(r,p):(zt(),X(Z[q],1,1,()=>{Z[q]=null}),Ut(),e=Z[t],e?e.p(r,p):(e=Z[t]=pt[t](r),e.c()),K(e,1),e.m(s,null)),(!I||p&8)&&P(w,r[3]),p&16&&x(h,"text-red-600",r[4]),qe===(qe=vt(r))&&U?U.p(r,p):(U.d(1),U=qe(r),U&&(U.c(),U.m(D,null))),p&32&&x(_,"startButton",!r[5]),p&32&&x(_,"stopButton",r[5]),(!I||p&256)&&T!==(T=r[8]("control.reset")+"")&&P($,T),(!I||p&256)&&ee!==(ee=r[8]("control.room")+"")&&P(oe,ee),(!I||p&256)&&E!==(E=r[8]("control.room_url")+"")&&P(re,E),(!I||p&2)&&P(ye,r[1]),(!I||p&256)&&Ee!==(Ee=r[8]("control.share_room_url")+"")&&P(je,Ee),(!I||p&256)&&Ie!==(Ie=r[8]("control.pin")+"")&&P(Ue,Ie),(!I||p&1)&&P($e,r[0]),(!I||p&256)&&Ne!==(Ne=r[8]("control.controller_url")+"")&&P(ze,Ne),(!I||p&2)&&P(Le,r[1]),(!I||p&256)&&Se!==(Se=r[8]("control.share_controller_url")+"")&&P(Oe,Se)},i(r){I||(K(e),K(te.$$.fragment,r),K(le.$$.fragment,r),I=!0)},o(r){X(e),X(te.$$.fragment,r),X(le.$$.fragment,r),I=!1},d(r){r&&a(s),Z[t].d(),r&&a(d),r&&a(k),U.d(),Te(te),Te(le),it=!1,$t(_t)}}}function el(o){let s,t;return s=new Ke({props:{icon:Gt,size:"2x"}}),{c(){Ae(s.$$.fragment)},l(e){Ve(s.$$.fragment,e)},m(e,d){Be(s,e,d),t=!0},p:ut,i(e){t||(K(s.$$.fragment,e),t=!0)},o(e){X(s.$$.fragment,e),t=!1},d(e){Te(s,e)}}}function tl(o){let s,t;return s=new Ke({props:{icon:Ht,size:"2x"}}),{c(){Ae(s.$$.fragment)},l(e){Ve(s.$$.fragment,e)},m(e,d){Be(s,e,d),t=!0},p:ut,i(e){t||(K(s.$$.fragment,e),t=!0)},o(e){X(s.$$.fragment,e),t=!1},d(e){Te(s,e)}}}function ll(o){let s=o[8]("control.start")+"",t;return{c(){t=g(s)},l(e){t=b(e,s)},m(e,d){ge(e,t,d)},p(e,d){d&256&&s!==(s=e[8]("control.start")+"")&&P(t,s)},d(e){e&&a(t)}}}function sl(o){let s=o[8]("control.stop")+"",t;return{c(){t=g(s)},l(e){t=b(e,s)},m(e,d){ge(e,t,d)},p(e,d){d&256&&s!==(s=e[8]("control.stop")+"")&&P(t,s)},d(e){e&&a(t)}}}function ol(o){let s,t,e,d,k,v;const h=[xt,Zt],w=[];function C(f,_){return f[2]&&!f[7]?0:1}return t=C(o),e=w[t]=h[t](o),{c(){s=n("div"),e.c(),this.h()},l(f){s=c(f,"DIV",{id:!0,class:!0});var _=i(s);e.l(_),_.forEach(a),this.h()},h(){u(s,"id","main"),u(s,"class","w-full h-full overflow-hidden svelte-qg5rdz")},m(f,_){ge(f,s,_),w[t].m(s,null),d=!0,k||(v=[se(Qt,"keydown",o[15]),se(s,"click",o[10],{once:!0})],k=!0)},p(f,[_]){let D=t;t=C(f),t===D?w[t].p(f,_):(zt(),X(w[D],1,1,()=>{w[D]=null}),Ut(),e=w[t],e?e.p(f,_):(e=w[t]=h[t](f),e.c()),K(e,1),e.m(s,null))},i(f){d||(K(e),d=!0)},o(f){X(e),d=!1},d(f){f&&a(s),w[t].d(),k=!1,$t(v)}}}function rl(o,s,t){let e,d,k;ft(o,Xt,m=>t(21,e=m)),ft(o,Mt,m=>t(7,d=m)),ft(o,Wt,m=>t(8,k=m));let v=e.params.roomId,h,w,C=!1,f,_,D="",R=!1,B,T,$=!1,y;Rt(()=>{t(1,w=window.location.host),e.url.searchParams.has("pin")?t(0,h=e.url.searchParams.get("pin")):(t(0,h=sessionStorage.getItem("PIN-"+v)),h||t(0,h=prompt("Please enter the control PIN for room "+v))),h?(sessionStorage.setItem("PIN-"+v,h),A(h),y=new Audio(V+"/audio/beep.mp3")):dt(V+"/")});function z(){t(6,$=!0),y.play(),y.pause(),y.load()}function A(m){f=new WebSocket(Kt+"://"+Yt+"/"+v+"?pin="+m),f.onerror=function(E){console.log(E)},f.onmessage=function(E){if(E.data==="ROOM_NOT_FOUND")alert("The room "+v+" does not exist"),dt(V+"/");else if(E.data==="WRONG_PIN")alert("Wrong PIN"),sessionStorage.removeItem("PIN-"+v),dt(V+"/");else if(E.data==="AUTHENTICATED")t(2,C=!0);else{let re=E.data.substring(0,1),ae=E.data.substring(2).includes(";")?E.data.substring(2).split(";"):[E.data.substring(2)];switch(re){case"t":t(16,_=parseInt(ae[1])),_==0?ee():oe();break;case"r":t(5,B=ae[0]==="1");break}}}}function j(){B?f.send("pause"):f.send("start")}function F(){f.send("reset")}function ee(){T===void 0&&(t(4,R=!0),be(),T=setInterval(function(){t(4,R=!R)},500))}function oe(){T&&(clearInterval(T),T=void 0,t(4,R=!1))}function be(){$&&(y.play(),setTimeout(function(){y.pause(),y.load()},2e3))}function Y(){navigator.share&&navigator.share({title:"Shot Clock room "+v,url:V+"/room/"+v})}function ke(){navigator.share&&navigator.share({title:"Shot Clock controller "+v,url:V+"/control/"+v})}function we(m){m.key===" "||m.key==="Enter"?(j(),m.preventDefault()):(m.key.toLowerCase()==="m"||m.key.toLowerCase()==="c"||m.key==="Backspace")&&(F(),m.preventDefault())}const L=()=>t(6,$=!$);return o.$$.update=()=>{o.$$.dirty&65536&&_!==void 0&&t(3,D=_.toString().padStart(2,"0"))},[h,w,C,D,R,B,$,d,k,v,z,j,F,Y,ke,we,_,L]}class ul extends Ot{constructor(s){super();qt(this,s,rl,ol,Ct,{})}}export{ul as default};
